#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

if [ "$ENFORCE_PREPUSH" != "1" ]; then
  echo "‚è≠Ô∏è  Skipping pre-push checks (set ENFORCE_PREPUSH=1 to enable)"
  exit 0
fi

echo "üîé Running pre-push checks (ENFORCE_PREPUSH=1)..."

# Build (fail fast if prod build breaks)
npm run build || exit 1

# Lint (if configured)
npm run lint || exit 1

# Unit tests
node --test tests/unit/*.test.cjs || exit 1

# Smoke E2E (fast)
npx playwright test -g @smoke --project=chromium || exit 1

echo "‚úÖ Pre-push checks passed"
